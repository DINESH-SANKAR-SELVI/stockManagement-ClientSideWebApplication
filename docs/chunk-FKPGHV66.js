import{P as l,T as i,Ub as d}from"./chunk-PACVBEL2.js";var s=class extends Error{};s.prototype.name="InvalidTokenError";function h(o){return decodeURIComponent(atob(o).replace(/(.)/g,(e,n)=>{let t=n.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}function f(o){let e=o.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return h(e)}catch{return atob(e)}}function c(o,e){if(typeof o!="string")throw new s("Invalid token specified: must be a string");e||(e={});let n=e.header===!0?0:1,t=o.split(".")[n];if(typeof t!="string")throw new s(`Invalid token specified: missing part #${n+1}`);let r;try{r=f(t)}catch(a){throw new s(`Invalid token specified: invalid base64 for part #${n+1} (${a.message})`)}try{return JSON.parse(r)}catch(a){throw new s(`Invalid token specified: invalid json for part #${n+1} (${a.message})`)}}var u=(()=>{let e=class e{get value(){return localStorage.getItem("userContext")}constructor(){}setContextPath(t="https://stockmanagement-server.onrender.com/"){localStorage.setItem("serverHostURL",t)}setUserContext(t){localStorage.setItem("userContext",btoa(JSON.stringify(t)))}removeAllLocalStorage(){localStorage.clear(),this.setContextPath()}isLoggedIn(){return!!(this.value!=null&&(this.decodedValue=atob(this.value),this.decodedValue&&(this.userContext=JSON.parse(this.decodedValue),(this.userContext!=null||this.userContext!=null)&&this.userContext.isAuthendicated)))}getAuthToken(){return this.value!=null&&(this.decodedValue=atob(this.value),this.decodedValue&&(this.userContext=JSON.parse(this.decodedValue),this.userContext!=null||this.userContext!=null))?this.userContext.token:""}getUserName(){let t=this.getAuthToken();if(t){let r=c(t);return console.log(r),r.sub}return""}hasRole(t){if(this.isLoggedIn())try{let r=c(this.userContext.token);if(r.roles)return r.roles.split(",").includes(t)}catch(r){console.error("Error decoding token:",r)}return!1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var k=(o,e)=>{let n=o.data.expectedRole,t=i(u),r=i(d);return t.hasRole(n)?!0:(r.navigate(["/login"]),!1)};export{u as a,k as b};
